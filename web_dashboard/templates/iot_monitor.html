<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ”Œ Ù…Ø±Ø§Ù‚Ø¨Ø© Ø£Ø¬Ù‡Ø²Ø© IoT - Secure City IQ</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Cairo', sans-serif;
        }

        body {
            background: linear-gradient(135deg, #0a0e27 0%, #0f1e38 100%);
            color: #ffffff;
            min-height: 100vh;
        }

        .navbar {
            background: rgba(10, 14, 39, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid #e74c3c;
            padding: 1rem 2rem;
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
        }

        .navbar h1 {
            color: #e74c3c;
            font-size: 1.8rem;
            font-weight: 700;
        }

        .navbar .subtitle {
            color: #c0392b;
            font-size: 0.9rem;
            margin-top: 0.2rem;
        }

        .nav-links {
            position: absolute;
            left: 2rem;
            top: 50%;
            transform: translateY(-50%);
        }

        .nav-links a {
            color: #c0392b;
            text-decoration: none;
            margin-left: 1.5rem;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .nav-links a:hover, .nav-links a.active {
            background: rgba(231, 76, 60, 0.2);
            color: #ff6b6b;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 6rem 2rem 2rem;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: rgba(26, 42, 78, 0.8);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(231, 76, 60, 0.3);
            border-radius: 15px;
            padding: 1.5rem;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(231, 76, 60, 0.3);
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #e74c3c, #ff6b6b);
        }

        .stat-icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            display: block;
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: #ff6b6b;
            margin-bottom: 0.5rem;
        }

        .stat-label {
            font-size: 1.1rem;
            color: #b0c4de;
            font-weight: 500;
        }

        .devices-section {
            background: rgba(26, 42, 78, 0.8);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(231, 76, 60, 0.3);
            border-radius: 15px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .devices-section h3 {
            color: #e74c3c;
            margin-bottom: 1rem;
            font-size: 1.3rem;
        }

        .device-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1rem;
        }

        .device-card {
            background: rgba(231, 76, 60, 0.1);
            border: 1px solid rgba(231, 76, 60, 0.3);
            border-radius: 10px;
            padding: 1rem;
            transition: all 0.3s ease;
        }

        .device-card:hover {
            background: rgba(231, 76, 60, 0.2);
            transform: translateY(-2px);
        }

        .device-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }

        .device-name {
            font-weight: 600;
            color: #ff6b6b;
        }

        .device-status {
            padding: 0.2rem 0.5rem;
            border-radius: 10px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .status-online {
            background: rgba(0, 255, 136, 0.2);
            color: #00ff88;
        }

        .status-offline {
            background: rgba(255, 170, 0, 0.2);
            color: #ffaa00;
        }

        .status-vulnerable {
            background: rgba(255, 68, 68, 0.2);
            color: #ff4444;
        }

        .device-details {
            font-size: 0.9rem;
            color: #b0c4de;
            margin-bottom: 0.5rem;
        }

        .device-risk {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.8rem;
        }

        .risk-bar {
            flex: 1;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            margin: 0 0.5rem;
            overflow: hidden;
        }

        .risk-fill {
            height: 100%;
            border-radius: 3px;
            transition: width 0.3s ease;
        }

        .risk-low { background: #00ff88; }
        .risk-medium { background: #ffaa00; }
        .risk-high { background: #ff4444; }
        .risk-critical { background: #8b0000; }

        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .chart-card {
            background: rgba(26, 42, 78, 0.8);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(231, 76, 60, 0.3);
            border-radius: 15px;
            padding: 1.5rem;
        }

        .chart-card h3 {
            color: #e74c3c;
            margin-bottom: 1rem;
            font-size: 1.3rem;
            text-align: center;
        }

        .chart-container {
            position: relative;
            height: 300px;
            width: 100%;
        }

        .controls-section {
            background: rgba(26, 42, 78, 0.8);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(231, 76, 60, 0.3);
            border-radius: 15px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .controls-section h3 {
            color: #e74c3c;
            margin-bottom: 1rem;
            font-size: 1.3rem;
        }

        .control-buttons {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .control-btn {
            background: rgba(231, 76, 60, 0.2);
            border: 1px solid rgba(231, 76, 60, 0.5);
            color: #ff6b6b;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .control-btn:hover {
            background: rgba(231, 76, 60, 0.4);
            transform: translateY(-2px);
        }

        .scan-status {
            margin-top: 1rem;
            padding: 0.5rem;
            border-radius: 8px;
            text-align: center;
            font-weight: 500;
        }

        .scan-active {
            background: rgba(0, 255, 136, 0.2);
            color: #00ff88;
        }

        .scan-inactive {
            background: rgba(255, 170, 0, 0.2);
            color: #ffaa00;
        }

        .alerts-section {
            background: rgba(26, 42, 78, 0.8);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(231, 76, 60, 0.3);
            border-radius: 15px;
            padding: 1.5rem;
        }

        .alerts-section h3 {
            color: #e74c3c;
            margin-bottom: 1rem;
            font-size: 1.3rem;
        }

        .alert-item {
            background: rgba(231, 76, 60, 0.1);
            border: 1px solid rgba(231, 76, 60, 0.3);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 0.8rem;
        }

        .alert-item.critical {
            background: rgba(139, 0, 0, 0.2);
            border-color: #8b0000;
        }

        .alert-time {
            color: #ff6b6b;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .alert-message {
            color: #ffb3b3;
            margin-top: 0.3rem;
            font-size: 0.9rem;
        }

        @media (max-width: 768px) {
            .container {
                padding: 5rem 1rem 1rem;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .charts-grid {
                grid-template-columns: 1fr;
            }

            .device-grid {
                grid-template-columns: 1fr;
            }

            .control-buttons {
                flex-direction: column;
            }

            .control-btn {
                width: 100%;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div>
            <h1>ğŸ”Œ Ù…Ø±Ø§Ù‚Ø¨Ø© Ø£Ø¬Ù‡Ø²Ø© IoT</h1>
            <div class="subtitle">Ù†Ø¸Ø§Ù… Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ø°ÙƒÙŠØ© ÙˆØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø®Ø§Ø·Ø±</div>
        </div>
        <div class="nav-links">
            <a href="/">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
            <a href="/threat-map">Ø®Ø±ÙŠØ·Ø© Ø§Ù„ØªÙ‡Ø¯ÙŠØ¯Ø§Øª</a>
            <a href="/analytics">Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª</a>
            <a href="/iot-monitor" class="active">Ù…Ø±Ø§Ù‚Ø¨Ø© IoT</a>
            <a href="/encryption-analysis">ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØªØ´ÙÙŠØ±</a>
            <a href="/settings">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</a>
        </div>
    </nav>

    <div class="container">
        <div class="stats-grid">
            <div class="stat-card">
                <span class="stat-icon">ğŸ”Œ</span>
                <div class="stat-value" id="total-devices">0</div>
                <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø©</div>
            </div>
            <div class="stat-card">
                <span class="stat-icon">ğŸŸ¢</span>
                <div class="stat-value" id="online-devices">0</div>
                <div class="stat-label">Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ù…ØªØµÙ„Ø©</div>
            </div>
            <div class="stat-card">
                <span class="stat-icon">ğŸš¨</span>
                <div class="stat-value" id="vulnerable-devices">0</div>
                <div class="stat-label">Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ù…Ø¹Ø±Ø¶Ø© Ù„Ù„Ø®Ø·Ø±</div>
            </div>
            <div class="stat-card">
                <span class="stat-icon">âš ï¸</span>
                <div class="stat-value" id="active-alerts">0</div>
                <div class="stat-label">Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø§Ù„Ù†Ø´Ø·Ø©</div>
            </div>
        </div>

        <div class="controls-section">
            <h3>ğŸ›ï¸ Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø©</h3>
            <div class="control-buttons">
                <button class="control-btn" id="scan-network">ğŸ” ÙØ­Øµ Ø§Ù„Ø´Ø¨ÙƒØ©</button>
                <button class="control-btn" id="start-monitoring">â–¶ï¸ Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø©</button>
                <button class="control-btn" id="stop-monitoring">â¹ï¸ Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø©</button>
                <button class="control-btn" id="export-devices">ğŸ’¾ ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
                <button class="control-btn" id="security-audit">ğŸ”’ ÙØ­Øµ Ø£Ù…Ù†ÙŠ</button>
            </div>
            <div id="scan-status" class="scan-status scan-inactive">
                Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø© Ù…ØªÙˆÙ‚ÙØ© - Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ "Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø©" Ù„Ø¨Ø¯Ø¡ Ø§Ù„ÙØ­Øµ
            </div>
        </div>

        <div class="charts-grid">
            <div class="chart-card">
                <h3>ğŸ“Š ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© Ø­Ø³Ø¨ Ø§Ù„Ù†ÙˆØ¹</h3>
                <div class="chart-container">
                    <canvas id="deviceTypesChart"></canvas>
                </div>
            </div>
            <div class="chart-card">
                <h3>ğŸ¢ ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© Ø­Ø³Ø¨ Ø§Ù„Ø´Ø±ÙƒØ© Ø§Ù„Ù…ØµÙ†Ø¹Ø©</h3>
                <div class="chart-container">
                    <canvas id="vendorChart"></canvas>
                </div>
            </div>
            <div class="chart-card">
                <h3>âš ï¸ Ù…Ø³ØªÙˆÙŠØ§Øª Ø§Ù„Ù…Ø®Ø§Ø·Ø±</h3>
                <div class="chart-container">
                    <canvas id="riskLevelsChart"></canvas>
                </div>
            </div>
            <div class="chart-card">
                <h3>ğŸ“ˆ Ø§ØªØ¬Ø§Ù‡Ø§Øª Ø§Ù„Ù†Ø´Ø§Ø·</h3>
                <div class="chart-container">
                    <canvas id="activityChart"></canvas>
                </div>
            </div>
        </div>

        <div class="devices-section">
            <h3>ğŸ”Œ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ù…ÙƒØªØ´ÙØ©</h3>
            <div id="devices-grid" class="device-grid">
                <div class="device-card">
                    <div class="device-header">
                        <div class="device-name">ğŸ“¹ ÙƒØ§Ù…ÙŠØ±Ø§ Ø£Ù…Ù†ÙŠØ© Hikvision</div>
                        <div class="device-status status-vulnerable">Ù…Ø¹Ø±Ø¶ Ù„Ù„Ø®Ø·Ø±</div>
                    </div>
                    <div class="device-details">
                        IP: 192.168.1.100 | Ù…Ù†ÙØ°: 80, 443 | Ø¢Ø®Ø± Ù†Ø´Ø§Ø·: 2 Ø¯Ù‚ÙŠÙ‚Ø©
                    </div>
                    <div class="device-risk">
                        <span>Ù…Ø®Ø§Ø·Ø± Ø£Ù…Ù†ÙŠØ© Ø¹Ø§Ù„ÙŠØ©</span>
                        <div class="risk-bar">
                            <div class="risk-fill risk-high" style="width: 85%"></div>
                        </div>
                        <span>85%</span>
                    </div>
                </div>

                <div class="device-card">
                    <div class="device-header">
                        <div class="device-name">ğŸµ Ù…ÙƒØ¨Ø± ØµÙˆØª Amazon Echo</div>
                        <div class="device-status status-online">Ù…ØªØµÙ„</div>
                    </div>
                    <div class="device-details">
                        IP: 192.168.1.101 | Ù…Ù†ÙØ°: 4070, 55442 | Ø¢Ø®Ø± Ù†Ø´Ø§Ø·: 1 Ø¯Ù‚ÙŠÙ‚Ø©
                    </div>
                    <div class="device-risk">
                        <span>Ù…Ø®Ø§Ø·Ø± Ø£Ù…Ù†ÙŠØ© Ù…Ù†Ø®ÙØ¶Ø©</span>
                        <div class="risk-bar">
                            <div class="risk-fill risk-low" style="width: 25%"></div>
                        </div>
                        <span>25%</span>
                    </div>
                </div>

                <div class="device-card">
                    <div class="device-header">
                        <div class="device-name">ğŸŒ¡ï¸ ØªØ±Ù…ÙˆØ³ØªØ§Øª Nest</div>
                        <div class="device-status status-online">Ù…ØªØµÙ„</div>
                    </div>
                    <div class="device-details">
                        IP: 192.168.1.102 | Ù…Ù†ÙØ°: 9553, 443 | Ø¢Ø®Ø± Ù†Ø´Ø§Ø·: 30 Ø«Ø§Ù†ÙŠØ©
                    </div>
                    <div class="device-risk">
                        <span>Ù…Ø®Ø§Ø·Ø± Ø£Ù…Ù†ÙŠØ© Ù…ØªÙˆØ³Ø·Ø©</span>
                        <div class="risk-bar">
                            <div class="risk-fill risk-medium" style="width: 55%"></div>
                        </div>
                        <span>55%</span>
                    </div>
                </div>

                <div class="device-card">
                    <div class="device-header">
                        <div class="device-name">ğŸ’¡ Ø¥Ø¶Ø§Ø¡Ø© Philips Hue</div>
                        <div class="device-status status-offline">ØºÙŠØ± Ù…ØªØµÙ„</div>
                    </div>
                    <div class="device-details">
                        IP: 192.168.1.103 | Ù…Ù†ÙØ°: 80, 443 | Ø¢Ø®Ø± Ù†Ø´Ø§Ø·: 2 Ø³Ø§Ø¹Ø©
                    </div>
                    <div class="device-risk">
                        <span>Ù…Ø®Ø§Ø·Ø± Ø£Ù…Ù†ÙŠØ© Ù…Ù†Ø®ÙØ¶Ø©</span>
                        <div class="risk-bar">
                            <div class="risk-fill risk-low" style="width: 15%"></div>
                        </div>
                        <span>15%</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="alerts-section">
            <h3>ğŸš¨ ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø§Ù„Ø£Ù…Ø§Ù†</h3>
            <div id="alerts-list">
                <div class="alert-item critical">
                    <div class="alert-time">2024-01-24 14:30:15</div>
                    <div class="alert-message">âš ï¸ Ø§ÙƒØªØ´Ø§Ù ÙƒØ§Ù…ÙŠØ±Ø§ Ø£Ù…Ù†ÙŠØ© Ù…Ø¹ Ø«ØºØ±Ø§Øª Ø£Ù…Ù†ÙŠØ© Ù…Ø¹Ø±ÙˆÙØ© - ÙŠÙÙ†ØµØ­ Ø¨ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠØ§Øª ÙÙˆØ±Ø§Ù‹</div>
                </div>
                <div class="alert-item">
                    <div class="alert-time">2024-01-24 14:25:30</div>
                    <div class="alert-message">ğŸ” ØªÙ… Ø§ÙƒØªØ´Ø§Ù Ø¬Ù‡Ø§Ø² IoT Ø¬Ø¯ÙŠØ¯ ÙÙŠ Ø§Ù„Ø´Ø¨ÙƒØ© - Ù…ÙƒØ¨Ø± ØµÙˆØª Amazon Echo</div>
                </div>
                <div class="alert-item">
                    <div class="alert-time">2024-01-24 14:20:45</div>
                    <div class="alert-message">ğŸ“¡ Ø¬Ù‡Ø§Ø² ØºÙŠØ± Ù…ØªØµÙ„ - Ø¥Ø¶Ø§Ø¡Ø© Philips Hue ØºÙŠØ± Ù…ØªØ§Ø­ Ø­Ø§Ù„ÙŠØ§Ù‹</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let deviceTypesChart = null;
        let vendorChart = null;
        let riskLevelsChart = null;
        let activityChart = null;

        // Initialize charts
        function initCharts() {
            // Device Types Chart
            const ctx1 = document.getElementById('deviceTypesChart').getContext('2d');
            deviceTypesChart = new Chart(ctx1, {
                type: 'doughnut',
                data: {
                    labels: ['ÙƒØ§Ù…ÙŠØ±Ø§Øª Ø£Ù…Ù†ÙŠØ©', 'Ù…ÙƒØ¨Ø±Ø§Øª ØµÙˆØª', 'ØªØ±Ù…ÙˆØ³ØªØ§Øª', 'Ø¥Ø¶Ø§Ø¡Ø© Ø°ÙƒÙŠØ©', 'Ø£Ø¬Ù‡Ø²Ø© Ø£Ø®Ø±Ù‰'],
                    datasets: [{
                        data: [2, 3, 1, 4, 1],
                        backgroundColor: [
                            '#e74c3c',
                            '#3498db',
                            '#2ecc71',
                            '#f39c12',
                            '#9b59b6'
                        ],
                        borderWidth: 2,
                        borderColor: '#1a2a4e'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: { color: '#ffffff' }
                        }
                    }
                }
            });

            // Vendor Chart
            const ctx2 = document.getElementById('vendorChart').getContext('2d');
            vendorChart = new Chart(ctx2, {
                type: 'bar',
                data: {
                    labels: ['Hikvision', 'Amazon', 'Google', 'Philips', 'TP-Link', 'Ø£Ø®Ø±Ù‰'],
                    datasets: [{
                        label: 'Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø©',
                        data: [2, 3, 1, 4, 2, 1],
                        backgroundColor: '#e74c3c',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: { color: 'rgba(255, 255, 255, 0.1)' },
                            ticks: { color: '#ffffff' }
                        },
                        x: {
                            grid: { color: 'rgba(255, 255, 255, 0.1)' },
                            ticks: { color: '#ffffff' }
                        }
                    },
                    plugins: {
                        legend: { labels: { color: '#ffffff' } }
                    }
                }
            });

            // Risk Levels Chart
            const ctx3 = document.getElementById('riskLevelsChart').getContext('2d');
            riskLevelsChart = new Chart(ctx3, {
                type: 'pie',
                data: {
                    labels: ['Ù…Ù†Ø®ÙØ¶', 'Ù…ØªÙˆØ³Ø·', 'Ø¹Ø§Ù„ÙŠ', 'Ø­Ø±Ø¬'],
                    datasets: [{
                        data: [6, 3, 2, 1],
                        backgroundColor: [
                            '#2ecc71',
                            '#f39c12',
                            '#e74c3c',
                            '#8b0000'
                        ],
                        borderWidth: 2,
                        borderColor: '#1a2a4e'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: { color: '#ffffff' }
                        }
                    }
                }
            });

            // Activity Chart
            const ctx4 = document.getElementById('activityChart').getContext('2d');
            activityChart = new Chart(ctx4, {
                type: 'line',
                data: {
                    labels: [],
                    datasets: [{
                        label: 'Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ù†Ø´Ø·Ø©',
                        data: [],
                        borderColor: '#e74c3c',
                        backgroundColor: 'rgba(231, 76, 60, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: { color: 'rgba(255, 255, 255, 0.1)' },
                            ticks: { color: '#ffffff' }
                        },
                        x: {
                            grid: { color: 'rgba(255, 255, 255, 0.1)' },
                            ticks: { color: '#ffffff' }
                        }
                    },
                    plugins: {
                        legend: { labels: { color: '#ffffff' } }
                    }
                }
            });
        }

        // Update IoT data
        async function updateIoTData() {
            try {
                const response = await fetch('/api/iot');
                const data = await response.json();

                if (data.iot_devices) {
                    // Update stats
                    document.getElementById('total-devices').textContent = data.iot_devices.length;
                    document.getElementById('online-devices').textContent =
                        data.iot_devices.filter(d => d.status === 'active').length;
                    document.getElementById('vulnerable-devices').textContent =
                        data.iot_devices.filter(d => d.risk_assessment?.risk_score >= 7).length;
                    document.getElementById('active-alerts').textContent = data.report?.active_threats || 0;

                    // Update charts with real data
                    updateCharts(data);
                }
            } catch (error) {
                console.error('Error updating IoT data:', error);
            }
        }

        // Update charts with data
        function updateCharts(data) {
            // Update activity chart
            if (activityChart) {
                const now = new Date().toLocaleTimeString();
                activityChart.data.labels.push(now);
                activityChart.data.datasets[0].data.push(data.iot_devices.filter(d => d.status === 'active').length);

                if (activityChart.data.labels.length > 20) {
                    activityChart.data.labels.shift();
                    activityChart.data.datasets[0].data.shift();
                }
                activityChart.update();
            }
        }

        // Control button handlers
        function setupControls() {
            document.getElementById('scan-network').addEventListener('click', () => {
                document.getElementById('scan-status').className = 'scan-status scan-active';
                document.getElementById('scan-status').textContent = 'ğŸ” Ø¬Ø§Ø±ÙŠ ÙØ­Øµ Ø§Ù„Ø´Ø¨ÙƒØ©...';
                setTimeout(() => {
                    document.getElementById('scan-status').className = 'scan-status scan-inactive';
                    document.getElementById('scan-status').textContent = 'âœ… ØªÙ… Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡ Ù…Ù† ÙØ­Øµ Ø§Ù„Ø´Ø¨ÙƒØ©';
                    updateIoTData();
                }, 3000);
            });

            document.getElementById('start-monitoring').addEventListener('click', () => {
                document.getElementById('scan-status').className = 'scan-status scan-active';
                document.getElementById('scan-status').textContent = 'â–¶ï¸ Ø¨Ø¯Ø¡ Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø£Ø¬Ù‡Ø²Ø©...';
            });

            document.getElementById('stop-monitoring').addEventListener('click', () => {
                document.getElementById('scan-status').className = 'scan-status scan-inactive';
                document.getElementById('scan-status').textContent = 'â¹ï¸ ØªÙ… Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø©';
            });

            document.getElementById('export-devices').addEventListener('click', () => {
                alert('Ø³ÙŠØªÙ… ØªØµØ¯ÙŠØ± Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø¬Ù‡Ø²Ø©');
            });

            document.getElementById('security-audit').addEventListener('click', () => {
                alert('Ø³ÙŠØªÙ… Ø¥Ø¬Ø±Ø§Ø¡ ÙØ­Øµ Ø£Ù…Ù†ÙŠ Ø´Ø§Ù…Ù„');
            });
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            initCharts();
            setupControls();
            updateIoTData();

            // Update every 30 seconds
            setInterval(updateIoTData, 30000);
        });
    </script>
</body>
</html>
