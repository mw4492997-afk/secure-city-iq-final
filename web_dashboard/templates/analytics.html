<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ“ˆ Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø© - Secure City IQ</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Cairo', sans-serif;
        }

        body {
            background: linear-gradient(135deg, #0a0e27 0%, #1a2a4e 100%);
            color: #ffffff;
            min-height: 100vh;
        }

        .navbar {
            background: rgba(10, 14, 39, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid #9b59b6;
            padding: 1rem 2rem;
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
        }

        .navbar h1 {
            color: #9b59b6;
            font-size: 1.8rem;
            font-weight: 700;
        }

        .navbar .subtitle {
            color: #8e44ad;
            font-size: 0.9rem;
            margin-top: 0.2rem;
        }

        .nav-links {
            position: absolute;
            left: 2rem;
            top: 50%;
            transform: translateY(-50%);
        }

        .nav-links a {
            color: #8e44ad;
            text-decoration: none;
            margin-left: 1.5rem;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .nav-links a:hover, .nav-links a.active {
            background: rgba(155, 89, 182, 0.2);
            color: #bb8fce;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 6rem 2rem 2rem;
        }

        .analytics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .analytics-card {
            background: rgba(26, 42, 78, 0.8);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(155, 89, 182, 0.3);
            border-radius: 15px;
            padding: 1.5rem;
        }

        .analytics-card h3 {
            color: #9b59b6;
            margin-bottom: 1rem;
            font-size: 1.3rem;
            text-align: center;
        }

        .chart-container {
            position: relative;
            height: 300px;
            width: 100%;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .metric-card {
            background: rgba(26, 42, 78, 0.8);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(155, 89, 182, 0.3);
            border-radius: 15px;
            padding: 1.5rem;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .metric-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #9b59b6, #bb8fce);
        }

        .metric-icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            display: block;
        }

        .metric-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: #bb8fce;
            margin-bottom: 0.5rem;
        }

        .metric-label {
            font-size: 1.1rem;
            color: #b0c4de;
            font-weight: 500;
        }

        .insights-section {
            background: rgba(26, 42, 78, 0.8);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(155, 89, 182, 0.3);
            border-radius: 15px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .insights-section h3 {
            color: #9b59b6;
            margin-bottom: 1rem;
            font-size: 1.3rem;
        }

        .insight-item {
            background: rgba(155, 89, 182, 0.1);
            border: 1px solid rgba(155, 89, 182, 0.3);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 0.8rem;
        }

        .insight-item.positive {
            background: rgba(0, 255, 136, 0.1);
            border-color: rgba(0, 255, 136, 0.3);
        }

        .insight-item.warning {
            background: rgba(255, 170, 0, 0.1);
            border-color: rgba(255, 170, 0, 0.3);
        }

        .insight-item.danger {
            background: rgba(255, 68, 68, 0.1);
            border-color: rgba(255, 68, 68, 0.3);
        }

        .insight-title {
            font-weight: 600;
            margin-bottom: 0.3rem;
        }

        .insight-description {
            font-size: 0.9rem;
            color: #b0c4de;
        }

        .time-selector {
            background: rgba(26, 42, 78, 0.8);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(155, 89, 182, 0.3);
            border-radius: 15px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .time-selector h3 {
            color: #9b59b6;
            margin-bottom: 1rem;
            font-size: 1.3rem;
        }

        .time-buttons {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .time-btn {
            background: rgba(155, 89, 182, 0.2);
            border: 1px solid rgba(155, 89, 182, 0.5);
            color: #bb8fce;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .time-btn:hover, .time-btn.active {
            background: rgba(155, 89, 182, 0.4);
            color: white;
        }

        .export-section {
            background: rgba(26, 42, 78, 0.8);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(155, 89, 182, 0.3);
            border-radius: 15px;
            padding: 1.5rem;
            text-align: center;
        }

        .export-section h3 {
            color: #9b59b6;
            margin-bottom: 1rem;
            font-size: 1.3rem;
        }

        .export-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .export-btn {
            background: rgba(155, 89, 182, 0.2);
            border: 1px solid rgba(155, 89, 182, 0.5);
            color: #bb8fce;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .export-btn:hover {
            background: rgba(155, 89, 182, 0.4);
            transform: translateY(-2px);
        }

        @media (max-width: 768px) {
            .container {
                padding: 5rem 1rem 1rem;
            }

            .analytics-grid, .metrics-grid {
                grid-template-columns: 1fr;
            }

            .time-buttons, .export-buttons {
                flex-direction: column;
                align-items: center;
            }

            .time-btn, .export-btn {
                width: 100%;
                max-width: 200px;
            }
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div>
            <h1>ğŸ“ˆ Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©</h1>
            <div class="subtitle">ØªØ­Ù„ÙŠÙ„Ø§Øª Ø§Ù„Ø£Ù…Ø§Ù† ÙˆØ§Ù„Ø£Ø¯Ø§Ø¡ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©</div>
        </div>
        <div class="nav-links">
            <a href="/">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
            <a href="/threat-map">Ø®Ø±ÙŠØ·Ø© Ø§Ù„ØªÙ‡Ø¯ÙŠØ¯Ø§Øª</a>
            <a href="/analytics" class="active">Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª</a>
            <a href="/iot-monitor">Ù…Ø±Ø§Ù‚Ø¨Ø© IoT</a>
            <a href="/encryption-analysis">ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØªØ´ÙÙŠØ±</a>
            <a href="/settings">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</a>
        </div>
    </nav>

    <div class="container">
        <div class="time-selector">
            <h3>â° Ù†Ø·Ø§Ù‚ Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ</h3>
            <div class="time-buttons">
                <button class="time-btn active" id="1h">Ø³Ø§Ø¹Ø© ÙˆØ§Ø­Ø¯Ø©</button>
                <button class="time-btn" id="24h">24 Ø³Ø§Ø¹Ø©</button>
                <button class="time-btn" id="7d">7 Ø£ÙŠØ§Ù…</button>
                <button class="time-btn" id="30d">30 ÙŠÙˆÙ…</button>
                <button class="time-btn" id="custom">Ù…Ø®ØµØµ</button>
            </div>
        </div>

        <div class="metrics-grid">
            <div class="metric-card">
                <span class="metric-icon">ğŸ“Š</span>
                <div class="metric-value" id="efficiency-score">95%</div>
                <div class="metric-label">ÙƒÙØ§Ø¡Ø© Ø§Ù„ÙƒØ´Ù</div>
            </div>
            <div class="metric-card">
                <span class="metric-icon">âš¡</span>
                <div class="metric-value" id="response-time">0.2s</div>
                <div class="metric-label">ÙˆÙ‚Øª Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©</div>
            </div>
            <div class="metric-card">
                <span class="metric-icon">ğŸ›¡ï¸</span>
                <div class="metric-value" id="coverage-rate">98%</div>
                <div class="metric-label">Ù…Ø¹Ø¯Ù„ Ø§Ù„ØªØºØ·ÙŠØ©</div>
            </div>
            <div class="metric-card">
                <span class="metric-icon">ğŸ¯</span>
                <div class="metric-value" id="accuracy-rate">96%</div>
                <div class="metric-label">Ø¯Ù‚Ø© Ø§Ù„ÙƒØ´Ù</div>
            </div>
        </div>

        <div class="analytics-grid">
            <div class="analytics-card">
                <h3>ğŸ“ˆ Ø§ØªØ¬Ø§Ù‡Ø§Øª Ø§Ù„ØªÙ‡Ø¯ÙŠØ¯Ø§Øª</h3>
                <div class="chart-container">
                    <canvas id="threatTrendsChart"></canvas>
                </div>
            </div>
            <div class="analytics-card">
                <h3>ğŸŒ ØªÙˆØ²ÙŠØ¹ Ø§Ù„ØªÙ‡Ø¯ÙŠØ¯Ø§Øª Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ</h3>
                <div class="chart-container">
                    <canvas id="geographicChart"></canvas>
                </div>
            </div>
            <div class="analytics-card">
                <h3>âš¡ Ø£Ø¯Ø§Ø¡ Ø§Ù„Ù†Ø¸Ø§Ù…</h3>
                <div class="chart-container">
                    <canvas id="performanceChart"></canvas>
                </div>
            </div>
            <div class="analytics-card">
                <h3>ğŸ” Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ù‡Ø¬Ù…Ø§Øª</h3>
                <div class="chart-container">
                    <canvas id="attackTypesChart"></canvas>
                </div>
            </div>
        </div>

        <div class="insights-section">
            <h3>ğŸ’¡ Ø§Ù„Ø±Ø¤Ù‰ ÙˆØ§Ù„ØªÙˆØµÙŠØ§Øª</h3>
            <div id="insights-list">
                <div class="insight-item positive">
                    <div class="insight-title">âœ… Ø£Ø¯Ø§Ø¡ Ù…Ù…ØªØ§Ø² ÙÙŠ Ø§Ù„ÙƒØ´Ù Ø¹Ù† Ø§Ù„ØªÙ‡Ø¯ÙŠØ¯Ø§Øª</div>
                    <div class="insight-description">Ù…Ø¹Ø¯Ù„ Ø§Ù„ÙƒØ´Ù Ø¹Ù† Ø§Ù„ØªÙ‡Ø¯ÙŠØ¯Ø§Øª Ø¨Ù„Øº 96% Ø®Ù„Ø§Ù„ Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ù…Ø§Ø¶ÙŠØ©</div>
                </div>
                <div class="insight-item warning">
                    <div class="insight-title">âš ï¸ Ø²ÙŠØ§Ø¯Ø© ÙÙŠ Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ø§Ù„ÙˆØµÙˆÙ„ ØºÙŠØ± Ø§Ù„Ù…ØµØ±Ø­ Ø¨Ù‡Ø§</div>
                    <div class="insight-description">ØªÙ… Ø±ØµØ¯ 15 Ù…Ø­Ø§ÙˆÙ„Ø© ÙˆØµÙˆÙ„ Ø¥Ø¶Ø§ÙÙŠØ© Ù…Ù‚Ø§Ø±Ù†Ø© Ø¨Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ù…Ø§Ø¶ÙŠ</div>
                </div>
                <div class="insight-item danger">
                    <div class="insight-title">ğŸš¨ Ø§ÙƒØªØ´Ø§Ù Ø«ØºØ±Ø© Ø£Ù…Ù†ÙŠØ© Ù…Ø­ØªÙ…Ù„Ø©</div>
                    <div class="insight-description">ÙŠÙÙ†ØµØ­ Ø¨ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠØ§Øª ÙˆØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØµØ­ÙŠØ­Ø§Øª Ø§Ù„Ø£Ù…Ù†ÙŠØ©</div>
                </div>
                <div class="insight-item positive">
                    <div class="insight-title">âœ… ØªØ­Ø³Ù† ÙÙŠ Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø´Ø¨ÙƒØ©</div>
                    <div class="insight-description">Ø§Ù†Ø®ÙØ§Ø¶ Ø²Ù…Ù† Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ø¨Ù†Ø³Ø¨Ø© 20% Ø¨Ø¹Ø¯ Ø§Ù„ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„Ø£Ø®ÙŠØ±Ø©</div>
                </div>
            </div>
        </div>

        <div class="export-section">
            <h3>ğŸ“¤ ØªØµØ¯ÙŠØ± Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª</h3>
            <div class="export-buttons">
                <button class="export-btn" id="export-pdf">ØªØµØ¯ÙŠØ± PDF</button>
                <button class="export-btn" id="export-csv">ØªØµØ¯ÙŠØ± CSV</button>
                <button class="export-btn" id="export-json">ØªØµØ¯ÙŠØ± JSON</button>
                <button class="export-btn" id="export-report">ØªÙ‚Ø±ÙŠØ± Ø´Ø§Ù…Ù„</button>
            </div>
        </div>
    </div>

    <script>
        let threatTrendsChart = null;
        let geographicChart = null;
        let performanceChart = null;
        let attackTypesChart = null;
        let currentTimeRange = '1h';

        // Initialize charts
        function initCharts() {
            // Threat Trends Chart
            const ctx1 = document.getElementById('threatTrendsChart').getContext('2d');
            threatTrendsChart = new Chart(ctx1, {
                type: 'line',
                data: {
                    labels: [],
                    datasets: [{
                        label: 'Ø§Ù„ØªÙ‡Ø¯ÙŠØ¯Ø§Øª',
                        data: [],
                        borderColor: '#ff4444',
                        backgroundColor: 'rgba(255, 68, 68, 0.1)',
                        tension: 0.4,
                        fill: true
                    }, {
                        label: 'Ø§Ù„Ø­Ø²Ù… Ø§Ù„Ø¢Ù…Ù†Ø©',
                        data: [],
                        borderColor: '#00ff88',
                        backgroundColor: 'rgba(0, 255, 136, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: { color: 'rgba(255, 255, 255, 0.1)' },
                            ticks: { color: '#ffffff' }
                        },
                        x: {
                            grid: { color: 'rgba(255, 255, 255, 0.1)' },
                            ticks: { color: '#ffffff' }
                        }
                    },
                    plugins: {
                        legend: { labels: { color: '#ffffff' } }
                    }
                }
            });

            // Geographic Chart
            const ctx2 = document.getElementById('geographicChart').getContext('2d');
            geographicChart = new Chart(ctx2, {
                type: 'bar',
                data: {
                    labels: ['Ø§Ù„Ø´Ø±Ù‚ Ø§Ù„Ø£ÙˆØ³Ø·', 'Ø£ÙˆØ±ÙˆØ¨Ø§', 'Ø¢Ø³ÙŠØ§', 'Ø£Ù…Ø±ÙŠÙƒØ§', 'Ø£Ø®Ø±Ù‰'],
                    datasets: [{
                        label: 'Ø¹Ø¯Ø¯ Ø§Ù„ØªÙ‡Ø¯ÙŠØ¯Ø§Øª',
                        data: [45, 32, 28, 19, 12],
                        backgroundColor: [
                            '#ff4444',
                            '#ff6600',
                            '#ffaa00',
                            '#ffff00',
                            '#9b59b6'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: { color: 'rgba(255, 255, 255, 0.1)' },
                            ticks: { color: '#ffffff' }
                        },
                        x: {
                            grid: { color: 'rgba(255, 255, 255, 0.1)' },
                            ticks: { color: '#ffffff' }
                        }
                    },
                    plugins: {
                        legend: { labels: { color: '#ffffff' } }
                    }
                }
            });

            // Performance Chart
            const ctx3 = document.getElementById('performanceChart').getContext('2d');
            performanceChart = new Chart(ctx3, {
                type: 'radar',
                data: {
                    labels: ['CPU', 'Ø°Ø§ÙƒØ±Ø©', 'Ø´Ø¨ÙƒØ©', 'Ù‚Ø±Øµ', 'Ø§Ø³ØªØ¬Ø§Ø¨Ø©'],
                    datasets: [{
                        label: 'Ø§Ù„Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø­Ø§Ù„ÙŠ',
                        data: [65, 75, 80, 70, 85],
                        borderColor: '#00d4ff',
                        backgroundColor: 'rgba(0, 212, 255, 0.2)',
                        pointBackgroundColor: '#00d4ff',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: '#00d4ff'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            grid: { color: 'rgba(255, 255, 255, 0.1)' },
                            angleLines: { color: 'rgba(255, 255, 255, 0.1)' },
                            ticks: { color: '#ffffff' },
                            pointLabels: { color: '#ffffff' }
                        }
                    },
                    plugins: {
                        legend: { labels: { color: '#ffffff' } }
                    }
                }
            });

            // Attack Types Chart
            const ctx4 = document.getElementById('attackTypesChart').getContext('2d');
            attackTypesChart = new Chart(ctx4, {
                type: 'pie',
                data: {
                    labels: ['Port Scanning', 'DDoS', 'Brute Force', 'SQL Injection', 'XSS', 'Ø£Ø®Ø±Ù‰'],
                    datasets: [{
                        data: [35, 25, 20, 10, 5, 5],
                        backgroundColor: [
                            '#ff4444',
                            '#ff6600',
                            '#ffaa00',
                            '#ffff00',
                            '#00ff88',
                            '#9b59b6'
                        ],
                        borderWidth: 2,
                        borderColor: '#1a2a4e'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: { color: '#ffffff' }
                        }
                    }
                }
            });
        }

        // Update analytics data
        async function updateAnalytics() {
            try {
                // Simulate data updates - in real implementation, this would fetch from API
                const now = new Date();
                const timeLabels = [];
                for (let i = 11; i >= 0; i--) {
                    timeLabels.push(now.toLocaleTimeString());
                    now.setMinutes(now.getMinutes() - 5);
                }

                // Update threat trends
                if (threatTrendsChart) {
                    threatTrendsChart.data.labels = timeLabels.reverse();
                    threatTrendsChart.data.datasets[0].data = Array.from({length: 12}, () => Math.floor(Math.random() * 20));
                    threatTrendsChart.data.datasets[1].data = Array.from({length: 12}, () => Math.floor(Math.random() * 100) + 50);
                    threatTrendsChart.update();
                }

                // Update performance metrics
                document.getElementById('efficiency-score').textContent = Math.floor(Math.random() * 10) + 90 + '%';
                document.getElementById('response-time').textContent = (Math.random() * 0.5 + 0.1).toFixed(1) + 's';
                document.getElementById('coverage-rate').textContent = Math.floor(Math.random() * 5) + 95 + '%';
                document.getElementById('accuracy-rate').textContent = Math.floor(Math.random() * 5) + 95 + '%';

            } catch (error) {
                console.error('Error updating analytics:', error);
            }
        }

        // Time range selector
        function setupTimeSelector() {
            document.querySelectorAll('.time-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.time-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    currentTimeRange = this.id;
                    updateAnalytics();
                });
            });
        }

        // Export functions
        function setupExportButtons() {
            document.getElementById('export-pdf').addEventListener('click', () => {
                alert('Ø³ÙŠØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª ÙƒÙ…Ù„Ù PDF');
            });

            document.getElementById('export-csv').addEventListener('click', () => {
                alert('Ø³ÙŠØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙƒÙ…Ù„Ù CSV');
            });

            document.getElementById('export-json').addEventListener('click', () => {
                alert('Ø³ÙŠØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙƒÙ…Ù„Ù JSON');
            });

            document.getElementById('export-report').addEventListener('click', async () => {
                try {
                    const response = await fetch('/api/export-report');
                    const data = await response.json();
                    if (data.status === 'success') {
                        alert(`ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø¨Ù†Ø¬Ø§Ø­: ${data.filename}`);
                    } else {
                        alert('ÙØ´Ù„ ÙÙŠ ØªØµØ¯ÙŠØ± Ø§Ù„ØªÙ‚Ø±ÙŠØ±');
                    }
                } catch (error) {
                    alert('Ø®Ø·Ø£ ÙÙŠ ØªØµØ¯ÙŠØ± Ø§Ù„ØªÙ‚Ø±ÙŠØ±');
                }
            });
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            initCharts();
            setupTimeSelector();
            setupExportButtons();
            updateAnalytics();

            // Update every 30 seconds
            setInterval(updateAnalytics, 30000);
        });
    </script>
</body>
</html>
