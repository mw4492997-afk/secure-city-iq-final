{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 60, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/MSI/Desktop/hhhh/src/app/api/scan-vulnerability/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\r\n\r\nconst scanUrl = async (url: string) => {\r\n  try {\r\n    const response = await fetch('http://localhost:5000/scan-vulnerability', {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n      body: JSON.stringify({ url }),\r\n    });\r\n\r\n    if (!response.ok) {\r\n      throw new Error(`HTTP error! status: ${response.status}`);\r\n    }\r\n\r\n    const data = await response.json();\r\n    return data;\r\n  } catch (error) {\r\n    console.error('Error calling Flask API:', error);\r\n    // Fallback to mock data if Flask API is not available\r\n    return {\r\n      valid: false,\r\n      status: 'Error',\r\n      error: 'Unable to connect to vulnerability scanner service',\r\n      details: { target: url, ssl: 'Unknown', threat_level: 'Unknown' }\r\n    };\r\n  }\r\n};\r\n\r\nexport async function POST(request: NextRequest) {\r\n  try {\r\n    const { url } = await request.json();\r\n\r\n    if (!url) {\r\n      return NextResponse.json({ error: 'يجب إدخال رابط صحيح' }, { status: 400 });\r\n    }\r\n\r\n    const results = await scanUrl(url);\r\n    return NextResponse.json(results);\r\n  } catch (error) {\r\n    console.error('Scan error:', error);\r\n    return NextResponse.json({ error: 'خطأ في الفحص' }, { status: 500 });\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;AAAA;;AAEA,MAAM,UAAU,OAAO;IACrB,IAAI;QACF,MAAM,WAAW,MAAM,MAAM,4CAA4C;YACvE,QAAQ;YACR,SAAS;gBACP,gBAAgB;YAClB;YACA,MAAM,KAAK,SAAS,CAAC;gBAAE;YAAI;QAC7B;QAEA,IAAI,CAAC,SAAS,EAAE,EAAE;YAChB,MAAM,IAAI,MAAM,CAAC,oBAAoB,EAAE,SAAS,MAAM,EAAE;QAC1D;QAEA,MAAM,OAAO,MAAM,SAAS,IAAI;QAChC,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,4BAA4B;QAC1C,sDAAsD;QACtD,OAAO;YACL,OAAO;YACP,QAAQ;YACR,OAAO;YACP,SAAS;gBAAE,QAAQ;gBAAK,KAAK;gBAAW,cAAc;YAAU;QAClE;IACF;AACF;AAEO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,EAAE,GAAG,EAAE,GAAG,MAAM,QAAQ,IAAI;QAElC,IAAI,CAAC,KAAK;YACR,OAAO,mJAAA,CAAA,eAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAsB,GAAG;gBAAE,QAAQ;YAAI;QAC3E;QAEA,MAAM,UAAU,MAAM,QAAQ;QAC9B,OAAO,mJAAA,CAAA,eAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,eAAe;QAC7B,OAAO,mJAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAe,GAAG;YAAE,QAAQ;QAAI;IACpE;AACF","debugId":null}}]
}